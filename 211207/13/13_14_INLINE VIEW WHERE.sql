USE MagicCorp
GO

SELECT DNAME, AVG_SAL
FROM (SELECT DNO, AVG(SALARY) AS AVG_SAL
	FROM EMPLOYEE
	GROUP BY DNO) AS S, DEPARTMENT D
WHERE S.DNO = D.DNO
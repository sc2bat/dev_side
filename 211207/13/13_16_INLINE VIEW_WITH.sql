USE MagicCorp
GO

WITH S(DNO, AVG_SAL)
AS(SELECT DNO, AVG(SALARY)
	FROM EMPLOYEE
	GROUP BY DNO)
SELECT DNAME, AVG_SAL
FROM S, DEPARTMENT
WHERE DEPARTMENT.DNO = S.DNO